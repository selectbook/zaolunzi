# diting (谛听)

streaming system(谛听 流计算系统)

流式系统是大数据领域中最热门的话题，
选择一个好的流式系统开源项目，并逐步深入研究，是掌握流式系统的核心法门。

2017年我在一家车联网公司使用的阿里巴巴改进后的Jstorm做流处理


纵观业内大规模采用的流式系统开源项目，storm,sparkstreaming,flink，flink是一个不错的选择。
但是flink的源码已经较为庞杂，想要吃透flink，已经较为困难。

这就涉及到如何选择一个好的开源项目，
我会选择一个新兴的（新兴的意味着该项目目前的代码复杂度不是很高，相对来说比较容易理解），
有不少成熟的工业界使用案例（有大公司采用最好），在github较为流行（star数一千以上），
社区活跃度很高(贡献者较多，pr提交频繁，issue较多，深度参与该项目的机会也就更多)。

在 github 上搜索 Stream processing ，比较一番过后，我认为比较值得参与的一个开源项目是 risingwave
这个项目是 rust 语言写的，首先需要了解rust

目前我在参与的是 rocketmq 的子项目 **rocketmq-streams**，希望一段时候后，能成为这个项目的主要贡献者。

另一个途径是参考先进的流式系统，自己实现一个最小化可用的流式系统，由此便诞生了本项目。

谛听是一个mini版的流式系统，但是实现了流式系统的核心概念。

Core streaming concepts：
流系统的核心概念：
event, 
job, 
source, 
operator, 
stream

Queue 队列在所有流系统中大量使用
传统的分布式系统通常是请求/响应模型（也称为同步模型）进行通信。对于流式系统，请求/响应模型在处理实时数据时会引入不必要的延迟。
在高层次上，分布式流系统与系统中的组件保持长时间运行的连接，以减少数据传输时间。
这种长时间运行的连接用于持续传输数据，并允许流系统在事件发生时对其迅速作出反应。

流式作业执行流程

* 传感器读取器从传感器读入数据并将事件存储在队列中，它就是 source。
* 车辆计数器负责对通过流的车辆进行计数。它是一个 operator。
* 数据从 source 到 operator 的连续移动是车辆事件流(stream of vehicle event)。

第一个流作业
通用步骤：
* 创建一个event类.

一个事件是一个单一的流中要由作业处理的数据。在diting框架中，API类Event负责存储或包装用户数据。其他流系统也会有类似的概念。
在该作业中，每个事件都代表一种车辆类型。现在为了简单起见，每种车辆类型都只是一个类似于car或者truck的字符串。
我们将VehicleEvent用作事件类的名称，它是从EventAPI 中的类扩展而来的。每个VehicleEvent对象都包含可以通过该getData()函数检索的车辆信息。  

* 创建 source
* 创建 operator.
* 连接这些组件.


